# 薛定谔方程 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解一维方势阱中的量子能级问题，具体目标包括：
- 理解量子力学中的方势阱模型及其能级方程
- 实现并可视化方势阱能级方程
- 使用二分法数值求解超越方程，计算粒子能级
- 分析不同能级的分布规律及物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 如何处理方程中的数值计算问题（如避免过小数值导致的计算误差）
- 二分法求解超越方程的具体实现策略
- 如何区分和处理偶宇称和奇宇称能级

_在此处填写您的方法描述（约200-300字）_
在数值计算中，为避免过小数值导致的计算误差，我们先对物理常量进行合理处理，如电子质量、普朗克常量等，在运算时将其量级相近的部分先行约掉。在计算函数值时，利用 numpy 库的向量化计算特性提高效率，同时对可能出现的无穷大或奇异值进行特殊处理，如使用 np.where(np.isinfinite(),, np.nan) 将无穷大值替换为 nan  。
 
二分法求解超越方程时，首先根据能级序号的奇偶性选择对应的方程（偶数能级用偶宇称方程，奇数能级用奇宇称方程 ）。然后初始化搜索区间，检查区间端点处函数值的符号是否相反，若相同则调整搜索区间。在迭代过程中，不断缩小区间，直至满足设定的精度要求。

## 3. 实验结果

### 3.1 能级方程可视化

请在此处粘贴您生成的能级方程图像，并简要说明图中各曲线的物理意义以及能级对应的交点位置。
![Figure_1](https://github.com/user-attachments/assets/4bf252ac-6aca-4f15-b2e3-94b84903dc19)

_在此处插入能级方程图像_

图像说明：
_在此处添加对图像的解释（约100字）_
图中绘制了三个函数曲线，y_1 = \tan\sqrt{\frac{w^{2}mE}{2\hbar^{2}}} 、y_2 = \sqrt{\frac{V - E}{E}}（偶宇称） 、y_3 = -\sqrt{\frac{E}{V - E}}（奇宇称） 。y_1反映了粒子在势阱中的量子行为的周期性特征；y_2和y_3分别对应偶宇称和奇宇称情况下能量与势阱高度的关系。能级对应于y_1与y_2（偶宇称能级）或y_1与y_3（奇宇称能级）的交点，这些交点表示粒子在势阱中可能存在的能量状态。
### 3.2 能级计算结果

请列出您计算得到的前6个能级值，并与参考值进行比较：

| 能级序号 | 计算值 (eV) | 参考值 (eV) | 相对误差 (%) |
|---------|------------|------------|-------------|
| 0       |  0.330     | 0.318      |  3.7        |
| 1       |  1.336     | 1.270      |  5.2        |
| 2       |  3.125     | 2.851      |  9.6        |
| 3       |  5.403     | 5.050      |  7.0        |
| 4       |  8.340     | 7.850      |  6.2        |
| 5       |  11.776    | 11.215     |  5.0        |

## 4. 分析与讨论

### 4.1 能级分布规律

请分析计算得到的能级分布规律，特别是：
- 能级间隔是否均匀？随着能级增加，间隔如何变化？
- 这种分布规律与经典物理有何不同？体现了量子力学的哪些特性？

_在此处填写您的分析（约200字）_
能级间隔不均匀。随着能级增加，能级间隔逐渐增大。这与经典物理中能量连续分布不同，体现了量子力学的离散性和量子化特性。在经典物理中，粒子能量可连续取值；而在量子力学里，粒子在势阱中只能处于特定的离散能级，这是由于波粒二象性及薛定谔方程的边界条件导致的。

### 4.2 计算方法的精度与效率

讨论您使用的二分法在求解此类问题时的优缺点：
- 计算精度如何？是否足以满足物理问题的需求？
- 计算效率如何？是否有可能使用其他方法（如牛顿法）提高效率？

_在此处填写您的讨论（约200字）_
二分法的优点是算法简单、收敛性有保证，只要初始区间选择合适且函数在区间内连续，就能收敛到方程的根。在本次计算中，设置精度为0.001 eV ，能较好满足物理问题对能量值精度的需求。缺点是收敛速度相对较慢，尤其是在接近根时收敛速度不会加快。相比牛顿法等迭代法，二分法每次迭代仅将区间缩小一半，而牛顿法利用函数的导数信息，在合适条件下收敛速度更快。但牛顿法需要计算函数导数且对初始值要求较高，可能出现不收敛情况，二分法在稳定性上更具优势。
### 4.3 思考题

1. 如果增加势阱宽度 $w$，能级将如何变化？请给出物理解释。

_在此处填写您的回答（约100字）_
如果增加势阱宽度w，能级将如何变化？请给出物理解释。
增加势阱宽度w ，能级将降低且能级间隔减小。从物理角度看，根据不确定关系\Delta x\Delta p\geq\frac{\hbar}{2} ，势阱宽度w增大意味着粒子在空间位置的不确定性\Delta x增大，则动量不确定性\Delta p减小，动能减小，总能量降低。同时，势阱宽度增大使得粒子在势阱内的“活动空间”增大，量子化效应相对减弱，能级间隔变小。
2. 如果将势阱高度 $V$ 改变，对能级分布有何影响？特别是，当 $V \to \infty$ 时，能级方程将如何简化？

_在此处填写您的回答（约100字）_
如果将势阱高度V改变，对能级分布有何影响？特别是，当V \to \infty时，能级方程将如何简化？
势阱高度V增大，能级升高且能级间隔增大。当V \to \infty ，势阱成为无限深势阱，此时粒子被完全限制在势阱内，边界条件变为波函数在势阱边界处为0 。能级方程简化为\sin\sqrt{\frac{w^{2}mE}{2\hbar^{2}}}=0 ，能级表达式为E_n=\frac{n^{2}\pi^{2}\hbar^{2}}{2mw^{2}}（n = 1, 2, 3, \cdots ），能级间隔与n的平方成正比，且能量值仅取决于势阱宽度w和粒子质量m 。

## 5. 结论

总结本实验的主要发现和收获，包括对量子力学基本概念的理解以及数值方法在物理问题中的应用。

_在此处填写您的结论（约150字）_
本实验通过实现和可视化方势阱能级方程，利用二分法求解能级，深入理解了量子力学中粒子在势阱中的行为。认识到量子能级的离散性与经典物理能量连续分布的差异，体会到数值方法在处理物理问题时的重要性和局限性。在后续学习中，可进一步探索更高效的数值算法，拓展对量子系统的研究。
## 核心代码片段

请粘贴您实现的关键函数代码（如二分法求解能级的函数），并简要说明代码的核心思路。

```python
# 在此处粘贴核心代码片段（不超过30行）
```def find_energy_level_bisection(n, V, w, m, precision=0.001, E_min=0.001, E_max=None):
    if E_max is None:
        E_max = V - 0.001
    if n % 2 == 0:
        equation = lambda E: energy_equation_even(E, V, w, m)
    else:
        equation = lambda E: energy_equation_odd(E, V, w, m)
    a, b = E_min, E_max
    fa, fb = equation(a), equation(b)
    if fa * fb > 0:
        raise ValueError("无法在给定区间内找到能级")
    while (b - a) > precision:
        c = (a + b) / 2
        fc = equation(c)
        if fc == 0:
            return c
        elif fa * fc < 0:
            b = c
        else:
            a = c
    return (a + b) / 2

代码说明：
_在此处简要解释代码的实现思路（约100字）_
此函数是二分法求解能级的核心代码。先根据能级奇偶性选择方程，确定搜索区间。检查区间端点函数值符号后，在循环中不断取区间中点，根据中点函数值与端点函数值关系缩小区间，直至区间宽度小于设定精度，返回近似能级值。
