# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
- 牛顿法和弦截法的实现策略
- 初值或初始区间的选择依据

_首先推导了L1点位置方程，该方程描述了在L1点处，卫星受到的地球引力、月球引力和离心力达到平衡的状态。物理意义上，L1点是地球和月球的引力以及卫星绕地球运动产生的离心力相互抵消的位置，使得卫星能够相对地球和月球保持静止。为了求解L1点的具体位置，我们实现了两种数值方法：牛顿法和弦截法。牛顿法利用函数的导数来迭代寻找方程的根，适用于导数连续且初始猜测值较接近真实解的情况。弦截法不需要计算导数，通过迭代逼近方程的根，适用于函数在初始区间内连续且端点函数值异号的情况。初值或初始区间的选择依据是L1点的理论位置应在地月距离的60%到100%之间。我们根据这一理论依据选择了初始猜测值和初始区间，以确保算法能够有效收敛到正确的解。通过这些方法，我们能够准确计算出L1点的位置，并验证了不同方法的求解结果。_

## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。

_![image](https://github.com/user-attachments/assets/2b630124-1f87-4aca-a310-bc077d6d408a)
_

图像说明：
_图中显示了L1拉格朗日点位置方程的曲线，其中横轴表示从地心到L1点的距离（以10^8米为单位），纵轴表示方程的值。图中的红色点标示了方程的零点，即L1点的实际位置，大约在3.2605亿米处。物理上，这个点是地球和月球引力以及卫星离心力平衡的位置，卫星在此点可以相对地球和月球保持静止，对于观测和通信等任务具有重要意义。_

### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

| 求解方法 |  L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|--------------|-------------------|---------|--------|
| 牛顿法   |3.26045164e+08|     0.848192      |    5    |   是   |
| 弦截法   |3.26044996e+08|     0.848192      |    5    |   是   |
| fsolve  |3.26045072e+08|     0.848192      | -       | -      |

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 |1.67623739e+02|0. 00005141|
| 牛顿法 vs fsolve |9.24189367e+01|0.00002835|
| 弦截法 vs fsolve |7.52048020e+01|0.00002307|

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
- 在L1点放置卫星有什么实际应用？

_L1点是地球和月球引力相互平衡的一个特殊点，卫星在这个点上受到的引力和离心力达到平衡，因此可以保持相对于地球和月球的相对静止状态。这种平衡状态意味着卫星不需要额外的推进力来维持其轨道位置，从而节省燃料和运行成本。在L1点放置卫星为地球和月球提供了一个稳定的观测平台，可以持续监测地球的气候和环境变化，以及月球的地质活动。其次，L1点卫星可以作为深空探测任务的中继站，为前往更远太空的探测器提供通信支持。此外，L1点的位置也适合部署太阳观测站，因为它可以持续观测太阳而不受地球大气层的干扰。_

### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
- 对初值/初始区间的敏感性
- 计算复杂度和实现难度

_牛顿法的收敛速度通常较快，特别是当初始猜测值接近真实解时，它可以达到二次收敛速度。然而，牛顿法对初值非常敏感，如果初始猜测值选择不当，可能导致不收敛或收敛到错误的解。此外，牛顿法需要计算函数的导数，这增加了计算复杂度和实现难度。相比之下，弦截法不需要计算导数，因此在计算复杂度上较低，实现起来也相对简单。弦截法对初始区间的选择有一定的要求，需要保证函数在初始区间的端点处异号，以确保存在根。弦截法的收敛速度通常慢于牛顿法，为线性收敛或超线性收敛，这意味着需要更多的迭代次数才能达到相同的精度。_

### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。

_如果将地球质量M增加，L1点的位置将向地球靠近。这是因为L1点的位置由地球和月球的引力平衡决定。当地球质量增加时，其引力增强，从而在更靠近地球的位置就能与月球的引力达到平衡，因此L1点会向地球移动。_

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？

_除了L1点，地球-月球系统还有L2、L3、L4和L5点。L2点位于地球的另一侧，与月球相对，L3点位于地球和月球的连线上，但在月球的另一侧。L4和L5点分别位于月球轨道的前后两侧，形成等边三角形的顶点。这些点的位置由地球和月球的引力以及卫星的离心力共同决定。L2点适合放置深空探测器的中继站，L4和L5点则可能成为未来太空殖民地的理想位置，因为它们相对稳定，可以减少维持轨道所需的能量。_

## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。

_本实验深入探讨了拉格朗日点的物理意义，尤其是L1点，它是由地球和月球的引力以及卫星的离心力共同作用形成的稳定点，对于空间观测和通信具有重要应用价值。实验通过数值方法，如牛顿法和弦截法，成功求解了L1点的位置，展示了这些方法在天体力学问题中的有效性。此外，实验还揭示了地球质量变化对L1点位置的影响，以及其它拉格朗日点的特点和潜在应用。通过这些发现，我们不仅加深了对拉格朗日点的理解，也认识到数值方法在解决复杂天体力学问题中的重要性，为未来的空间任务规划和天体动力学研究提供了有力的工具。_

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

```python
# def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    x = x0
    iterations = 0
    converged = False
    for i in range(max_iter):
        fx = f(x)
        if abs(fx) < tol:
            converged = True
            iterations = i + 1
            break
        dfx = df(x)
        if abs(dfx) < 1e-14:  # 避免除以接近零的数
            break
        delta = fx / dfx
        x_new = x - delta
        # 检查相对变化是否小于容差
        if abs(delta / x) < tol:
            converged = True
            iterations = i + 1
            x = x_new
            break
        x = x_new
        iterations = i + 1
    return x, iterations, converged     
```

代码说明：
_该代码通过牛顿法求解方程 f(x) = 0。从初始值开始，迭代计算函数值和导数值，更新x值。若函数值的绝对值或变化量小于设定容差，则认为已收敛。若导数值过小则停止迭代，避免除零错误。最终返回近似解、迭代次数和收敛标志。此方法适用于导数存在且初始值接近真实解的情况。_
